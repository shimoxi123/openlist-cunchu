# github https://github.com/Meloong-Git/PCL

# 爱发电 https://afdian.com/a/LTCat


## 更新日志

2.11.2 最新发行版
@LTCatt LTCatt 发布于 昨天
· 1 个提交 在此发行版之后进入 main 分支
 2.11.2
 efd480f
联机优化
若有加入者的网络环境比房主更好，会提示可以让那位加入者担任房主
中继节点负载均衡算法优化
只选择 MC 中继节点进行连接，避免连接到低质量节点导致卡顿
大幅降低节点在线率在负载算法中的权重
允许自动选择非 TCP 协议的、带有即将下线标签的、在线状态不是优秀的节点
会有 1% 的概率选择 0 负载的节点，而不是固定不选择它们（如果节点存在问题，可能才导致它是 0 负载，所以此前不会选择它们，但这又会导致 PCL 不会连接新增的节点）
现在会在多个禁止中继的节点中选择一个作为发现节点，以实现负载均衡
会检查是否与房主都设置了自定义节点，以防只有一方设置了导致连不上
允许设置优先直连或优先低延迟，以降低节点中转负载
为侦听的端口号添加了一定的随机性，以降低端口被占用的概率（#7451，@dongtz123）
若正使用中继节点，会更准确地显示网络情况
仅创建房间时不再连接中继节点
为节点列表 API 添加了缓存作为回退，以提高可用性
联机设置的贡献节点选项会给出更详细的说明
若联机模块因为端口被占用而崩溃，会给出详细的解决方案
更新联机的内置帮助，现在离线模式直接选择房间就能加入，不应手动输入 IP（LTCatt/PCL2Help#437，PR @kuankqaq）
修复了以下 4 个联机相关的 Bug
新用户首次启动联机可能出错（#7346）
俄语等环境下无法正常联机（#7435，@Arrogant-BOT）
创建房间时会显示“正在连接到房主”
启动联机时会冗余地检查一次配置
其他更新内容
帮助库中添加对 Oculus 的介绍（LTCatt/PCL2Help#440，PR @kuankqaq）
Bug 修复
若没有 Path 环境变量则无法启动游戏（#7444，@Cshdhshsj）
帮助库中“将 PCL 添加到 Windows 安全中心白名单”的配图有误（LTCatt/PCL2Help#426，@lihartx，PR @kuankqaq）

嘿，联机的优化来了！现在离线登录也能直接加入房间，不需要房主装 Mod 啦！

不过，MC 玩家实在太多了。根据目前的数据，如果要让联机能在正式版 PCL 稳定中继，可能还需要 100 个服务器节点……
所以…… **我们需要你的帮助！！！**
如果你有空闲的服务器，非常欢迎 [搭建一个共享节点](https://easytier.cn/guide/network/host-public-server.html)，搭建后在 [此处](https://uptime.easytier.cn/submit) 提交，然后大家就可以使用你的服务器辅助联机了！
如果大家能出一份力，这或许也不是不可能的事……

此外，如果你在 10 月仅赞助了 6.66 档位，也可以收到这个版本的更新！我知道 6.66 档位不包含后续更新，所以仅此一次哦……看看爱发电私信吧 :D
**祝大家联机愉快！**

---

### 联机优化
- 使用离线登录也可以直接加入联机房间了
- 若复制了邀请码，则可以直接快速加入房间
- 会从所有共享节点中自动选择负载最低的进行中继连接（#7383，@zkitefly）
- 关闭 PCL 时总是会提示是否退出联机，防止在关闭 PCL 时无意地关闭或退出了房间（#7357，@baguotao233）
- 允许自定义要连接的节点
- 若通过中继连接到房主，会显示中继情况与层数
- 在设置添加“贡献节点”和“查看节点状态”按钮，暂时移除老好人模式
- 帮助库更新：添加联机教程（LTCatt/PCL2Help#436，PR @WForst-Breeze）
- 修复 RPC 端口被占用导致 CLI 无法获取输出的 Bug（#7351，@tangge233）
- 修复 Listener 端口被占用导致启动联机模块失败的 Bug
- 修复了 PCL 的联机无法与其他手动开启的 EasyTier 正常共存的 Bug

### 其他更新内容
- 新主页预设：Minecraft 更新摘要（#7380，作者 @pynickle）
- 将社区资源的最新版本筛选改为 1.21.10
- 将 EasyTier 添加到特别鸣谢！非常感谢 EasyTier 提供了联机模块！
- 更新 10 月赞助者列表，感谢大家的超级支持！

### Bug 修复
- 家园披风的翻译缺失（#7353，@YANHAORANG，PR @wyc-26）
- 启动第三方客户端时可能出错：分析资源文件索引地址失败（#7369，@LuckyPotion）
- 下载失败时，下载管理页面可能不会显示完整的错误信息
- 依然无法处理部分网络请求的超时

### 技术性更改
- 新自定义事件类型：加入房间，可用于自动加入指定邀请码的联机房间
- 换用 JSON 输出解析 CLI 结果（#7351，@tangge233）
- ValidateInteger 已允许输入前导 0（#7375，@llzlloll，PR @wyc-26）
